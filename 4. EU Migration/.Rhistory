by = c("country_code", "year")) %>% View()
left_join(country_codes, by = c("country_code" = "a2_code"))
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year"))
gdp_raw %>%
mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "na_item,unit,geo\\time") %>%
separate(variable, into = c("a", "gdp_metric", "country_code"),
sep = ",") %>%
filter(gdp_metric %in% c("CP_EUR_HAB", "CP_MPPS")) %>%
select(-a) %>%
gather(key = year, value = gdp, `2006`:`2017`) %>%
mutate(gdp = as.numeric(gdp))
filter(gdp_clean, gdp_metric == "CP_EUR_HAB")
filter(gdp_clean, gdp_metric == "CP_MPPS")
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>% View()
left_join(country_codes, by = c("country_code" = "a2_code"))
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005)
migration_clean <-
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005)
rm(imm_clean, emm_clean, pop_clean, country_codes, gdp_clean)
rm(immigration_raw, emmigration_raw, population_raw, gdp_raw)
migration_clean %>%
select(country, year, net_migration_per_cap) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, gdp_per_capita,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "GDP per Capita - Ordered By 2016 Population",
x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean %>%
select(country, year, gdp_per_capita) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, gdp_per_capita,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "GDP per Capita - Ordered By 2016 Population",
x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
country_order_by_gdp_per_capita <-
(migration_clean %>%
filter(year == 2016) %>%
arrange(desc(gdp_per_capita)))$country
migration_clean %>%
select(country, year, gdp_per_capita) %>%
mutate(country = factor(country,
levels = country_order_by_gdp_per_capita)) %>%
ggplot(aes(year, gdp_per_capita,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "GDP per Capita - Ordered By 2016 Population",
x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean %>%
select(country, year, net_migration_per_cap) %>%
mutate(country = factor(country,
levels = country_order_by_gdp_per_capita)) %>%
ggplot(aes(year, net_migration_per_cap,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "GDP per Capita - Ordered By 2016 Population",
x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean <-
migration_clean %>%
mutate(net_migration_per_gdp_pps = net_migration / gdp_pps)
migration_clean %>%
select(country, year, net_migration_per_gdp_pps) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, net_migration_per_gdp_pps * 1000,000,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "European Net Migration per 1000 - Ordered By 2016 Population", x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean %>%
select(country, year, net_migration_per_gdp_pps) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, (net_migration_per_gdp_pps * 1000000),
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "European Net Migration per 1000 - Ordered By 2016 Population", x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean <-
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population,
gdp_pps_per_net_migrant = gdp_pps / net_migration) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = '../' )
library(tidyverse)
library(stringr)
# Chunk 2: import
emmigration_raw <- readr::read_tsv("./data/tps00177_emmigration.tsv")
immigration_raw <- readr::read_tsv("./data/tps00176_immigration.tsv")
population_raw <- readr::read_tsv("./data/tps00001_population.tsv")
gdp_raw <- readr::read_tsv("./data/tec00001_GDP.tsv")
# Country codes are ISO standard, except for Greece
# (GR -> EL) and United Kingdom (GB -> UK).
# http://www.nationsonline.org/oneworld/country_code_list.htm
country_codes <- readr::read_csv("./data/world_country_codes.csv")
# Chunk 3: clean
imm_clean <-
immigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = immigrants, `2005`:`2016`) %>%
mutate(immigrants = as.numeric(immigrants))
emm_clean <-
emmigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = emmigrants, `2005`:`2016`) %>%
mutate(emmigrants = as.numeric(emmigrants))
pop_clean <-
population_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "indic_de,geo\\time") %>%
separate(variable, into = c("a", "country_code"),
sep = ",") %>%
select(-a) %>%
gather(key = year, value = population, `2006`:`2017`) %>%
mutate(population = as.numeric(population))
gdp_clean <-
gdp_raw %>%
mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "na_item,unit,geo\\time") %>%
separate(variable, into = c("a", "gdp_metric", "country_code"),
sep = ",") %>%
filter(gdp_metric %in% c("CP_EUR_HAB", "CP_MPPS")) %>%
select(-a) %>%
gather(key = year, value = gdp, `2006`:`2017`) %>%
mutate(gdp = as.numeric(gdp))
migration_clean <-
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population,
gdp_pps_per_net_migrant = gdp_pps / net_migration) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005)
rm(imm_clean, emm_clean, pop_clean, country_codes, gdp_clean)
rm(immigration_raw, emmigration_raw, population_raw, gdp_raw)
is.na(migration_clean) %>% sum() # No NA's for this subset!
glimpse(migration_clean)
# Chunk 4
migration_clean$country %>% unique()
migration_clean$country %>% unique() %>% length()
# Chunk 5
migration_year_summary <-
migration_clean %>%
group_by(year) %>%
summarise(sum_immigrants = sum(immigrants),
sum_emmigrants = sum(emmigrants),
total_population = sum(population),
total_net_migration = sum(net_migration),
mean_net_migration_per_capita = mean(net_migration_per_cap))
migration_country_summary <-
migration_clean %>%
group_by(country) %>%
summarise(sum_immigrants = sum(immigrants),
sum_emmigrants = sum(emmigrants),
total_population = sum(population),
total_net_migration = sum(net_migration),
mean_net_migration_per_capita = mean(net_migration_per_cap))
# European-wide immigration vs emmigration
migration_year_summary %>% ungroup() %>%
select(year, sum_immigrants, sum_emmigrants) %>%
gather(key = "movement_type", value = "count",
sum_immigrants:sum_emmigrants) %>%
ggplot(aes(year, count, colour = movement_type, group = movement_type)) +
geom_line(size = 1.5) +
blorg::blog_theme +
scale_colour_manual(values = blorg::blog_palette)
# Country number immigrants
migration_clean %>% ungroup() %>%
select(country, year, immigrants) %>%
ggplot(aes(year, immigrants, colour = country, group = country)) +
geom_line(size = 1.5) +
blorg::blog_theme
# Net migration per capita
migration_clean %>%
select(country, year, net_migration_per_cap) %>%
ggplot(aes(year, net_migration_per_cap * 1000,
colour = country, group = country)) +
geom_line(size = 1.5) +
blorg::blog_theme
# Chunk 6
most_net_migrants <-
migration_country_summary %>% ungroup() %>%
arrange(total_net_migration) %>%
select(country, total_net_migration) %>%
top_n(3)
migration_clean$countries_most_net_migrants <-
if_else(migration_clean$country %in% most_net_migrants$country,
migration_clean$country, "Other")
migration_clean %>%
select(countries_most_net_migrants, year, net_migration) %>%
group_by(countries_most_net_migrants, year) %>%
summarise(total_net_migration = sum(net_migration)) %>%
ggplot(aes(year, total_net_migration,
colour = countries_most_net_migrants,
group = countries_most_net_migrants)) +
geom_path(size = 1.5) +
blorg::blog_theme +
scale_colour_manual(values = blorg::blog_palette)
# Chunk 7
migration_clean %>%
select(countries_most_net_migrants, year, net_migration) %>%
group_by(countries_most_net_migrants, year) %>%
summarise(total_net_migration = sum(net_migration)) %>%
ggplot(aes(year, total_net_migration,
fill = countries_most_net_migrants,
group = countries_most_net_migrants)) +
geom_bar(position = "stack", stat = "identity") +
blorg::blog_theme +
scale_fill_manual(values = blorg::blog_palette)
# Chunk 8
country_order_by_pop <-
(migration_clean %>%
filter(year == 2016) %>%
arrange(desc(population)))$country
migration_clean %>%
select(country, year, net_migration_per_cap) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, net_migration_per_cap * 1000,
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "European Net Migration per 1000 - Ordered By 2016 Population", x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
# Chunk 9
country_order_by_gdp_per_capita <-
(migration_clean %>%
filter(year == 2016) %>%
arrange(desc(gdp_per_capita)))$country
migration_clean %>%
select(country, year, gdp_pps_per_net_migrant) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, (gdp_pps_per_net_migrant * 1000000),
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "European Net Migration per 1000 - Ordered By 2016 Population", x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean %>%
select(country, year, gdp_pps_per_net_migrant) %>%
mutate(country = factor(country, levels = country_order_by_pop))
imm_clean <-
immigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = immigrants, `2005`:`2016`) %>%
mutate(immigrants = as.numeric(immigrants))
emm_clean <-
emmigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = emmigrants, `2005`:`2016`) %>%
mutate(emmigrants = as.numeric(emmigrants))
pop_clean <-
population_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "indic_de,geo\\time") %>%
separate(variable, into = c("a", "country_code"),
sep = ",") %>%
select(-a) %>%
gather(key = year, value = population, `2006`:`2017`) %>%
mutate(population = as.numeric(population))
gdp_clean <-
gdp_raw %>%
mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "na_item,unit,geo\\time") %>%
separate(variable, into = c("a", "gdp_metric", "country_code"),
sep = ",") %>%
filter(gdp_metric %in% c("CP_EUR_HAB", "CP_MPPS")) %>%
select(-a) %>%
gather(key = year, value = gdp, `2006`:`2017`) %>%
mutate(gdp = as.numeric(gdp))
emmigration_raw <- readr::read_tsv("./data/tps00177_emmigration.tsv")
immigration_raw <- readr::read_tsv("./data/tps00176_immigration.tsv")
population_raw <- readr::read_tsv("./data/tps00001_population.tsv")
gdp_raw <- readr::read_tsv("./data/tec00001_GDP.tsv")
# Country codes are ISO standard, except for Greece
# (GR -> EL) and United Kingdom (GB -> UK).
# http://www.nationsonline.org/oneworld/country_code_list.htm
country_codes <- readr::read_csv("./data/world_country_codes.csv")
imm_clean <-
immigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = immigrants, `2005`:`2016`) %>%
mutate(immigrants = as.numeric(immigrants))
emm_clean <-
emmigration_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "citizen,agedef,age,unit,sex,geo\\time") %>%
separate(variable, into = c("a", "b", "c", "d", "e", "country_code"),
sep = ",") %>%
filter(b == "COMPLET") %>%
select(-a, -b, -c, -d, -e) %>%
gather(key = year, value = emmigrants, `2005`:`2016`) %>%
mutate(emmigrants = as.numeric(emmigrants))
pop_clean <-
population_raw %>% mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "indic_de,geo\\time") %>%
separate(variable, into = c("a", "country_code"),
sep = ",") %>%
select(-a) %>%
gather(key = year, value = population, `2006`:`2017`) %>%
mutate(population = as.numeric(population))
gdp_clean <-
gdp_raw %>%
mutate_at(.vars = vars(starts_with("2")),
.funs = stringr::str_extract,
pattern = "[0-9]+") %>%
dplyr::rename(variable = "na_item,unit,geo\\time") %>%
separate(variable, into = c("a", "gdp_metric", "country_code"),
sep = ",") %>%
filter(gdp_metric %in% c("CP_EUR_HAB", "CP_MPPS")) %>%
select(-a) %>%
gather(key = year, value = gdp, `2006`:`2017`) %>%
mutate(gdp = as.numeric(gdp))
migration_clean <-
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population,
gdp_pps_per_net_migrant = gdp_pps / net_migration) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005)
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005) %>%
mutate(gdp_pps_per_net_migrant = gdp_pps / net_migration)
migration_clean <-
imm_clean %>%
left_join(emm_clean, by = c("country_code", "year")) %>%
left_join(pop_clean, by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_EUR_HAB"),
by = c("country_code", "year")) %>%
left_join(filter(gdp_clean, gdp_metric == "CP_MPPS"),
by = c("country_code", "year")) %>%
left_join(country_codes, by = c("country_code" = "a2_code")) %>%
mutate(net_migration = immigrants - emmigrants,
net_migration_per_cap = net_migration / population) %>%
rename(gdp_per_capita = gdp.x, gdp_pps = gdp.y) %>%
select(-a3_code, -num_code, -gdp_metric.x, -gdp_metric.y) %>%
filter(!(country %in% c("Bulgaria", "Belgium",
"Liechtenstein", "Romania"))) %>%
filter(year != 2005) %>%
mutate(gdp_pps_per_net_migrant = gdp_pps / net_migration)
migration_clean %>%
select(country, year, gdp_pps_per_net_migrant) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, (gdp_pps_per_net_migrant * 1000000),
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "European Net Migration per 1000 - Ordered By 2016 Population", x = "Year", y = "Net Migration per 1000 Population") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
migration_clean %>%
select(country, year, gdp_pps, immigrants) %>%
mutate(country = factor(country, levels = country_order_by_pop)) %>%
ggplot(aes(year, (gdp_pps / immigrants),
fill = country, group = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
facet_wrap(~country, ncol = 7) +
theme(legend.position = "none") +
labs(title = "", x = "Year", y = "") +
scale_x_discrete(breaks = scales::pretty_breaks(n = 5))
