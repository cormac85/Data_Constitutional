foo_lev
OECD::search_dataset("world", ignore.case = TRUE)
OECD::search_dataset("world indicator", ignore.case = TRUE)
OECD::search_dataset("primary", ignore.case = TRUE)
remove.packages("OECD")
remove.packages("XML", "rsdmx")
remove.packages("XML")
remove.packages("rsdmx")
knitr::opts_chunk$set(echo = TRUE)
if(!interactive()){
setwd("../")
}
primary_energy <- readr::read_csv("../data/primary_energy.csv")
View(primary_energy)
primary_energy <- readr::read_csv("../data/primary_energy.csv")
readr::read_csv("../data/primary_energy.csv") %>%
gather(`1960`:`2016`)
library(tidyverse)
readr::read_csv("../data/primary_energy.csv") %>%
gather(`1960`:`2016`)
readr::read_csv("../data/primary_energy.csv") %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`)
primary_energy <-
readr::read_csv("../data/primary_energy.csv") %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`)
View(primary_energy)
primary_energy %>%
filter(country %in% c("United States", "China", "India")) %>%
ggplot(aes(year, million_tonnes_equivalent)) %>%
geom_bar()
primary_energy %>%
filter(country %in% c("United States", "China", "India")) %>%
ggplot(aes(year, million_tonnes_equivalent)) +
geom_bar()
primary_energy %>%
filter(country %in% c("United States", "China", "India")) %>%
ggplot(aes(year, million_tonnes_equivalent)) +
geom_bar(stat = "identity")
primary_energy %>%
filter(country %in% c("United States", "China", "India")) %>%
ggplot(aes(year, million_tonnes_equivalent, colour = country)) +
geom_bar(stat = "identity")
readr::read_tsv("../data/primary_energy_draft.tsv")
readr::read_tsv("../data/primary_energy_draft.tsv")
readr::read_csv("../data/primary_energy.csv")
getwd()
readr::read_csv("./data/primary_energy_draft.tsv")
readr::read_tsv("./data/primary_energy_draft.tsv")
readr::read_tsv("./data/primary_energy_draft.tsv")
readr::read_tsv("./data/primary_energy_draft.tsv")
readr::read_tsv("./data/primary_energy_draft.tsv") %>% View()
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58) %>% View()
primary_energy %>%
filter(country %in% c("United States", "China", "India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity")
library(tidyverse)
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58) %>%
rename_if(contains("X"), tolower) %>% View()
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58) %>%
rename_at(vars(starts_with("X")), function(){1960:2016}) %>% View()
names(primary_energy)[2:ncol(primary_energy)]
primary_energy <-
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
names(primary_energy)[2:ncol(primary_energy)]
names(primary_energy)[2:ncol(primary_energy)] <- 1960:2016
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`)
primary_energy <-
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`)
primary_energy %>%
filter(country %like% c("United States", "China", "India"))
primary_energy %>%
filter(stringr::str_detect(country, "China"))
primary_energy %>%
filter(stringr::str_detect(country, c("China (P", "United States")))
primary_energy %>%
filter(stringr::str_detect(country,"China (P|United States|India"))
primary_energy %>%
filter(stringr::str_detect(country,"China (P"))
primary_energy %>%
filter(stringr::str_detect(country,"China /(P"))
primary_energy %>%
filter(stringr::str_detect(country,"China //(P"))
primary_energy %>%
filter(stringr::str_detect(country,"China \(P"))
primary_energy %>%
filter(stringr::str_detect(country, "China ("))
primary_energy %>%
filter(stringr::str_detect(country, "China"))
primary_energy %>%
filter(stringr::str_detect(country, "China "))
primary_energy %>%
filter(stringr::str_detect(country, "China |United States|India"))
primary_energy %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity")
primary_energy %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy <-
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
names(primary_energy)[2:ncol(primary_energy)] <- 1960:2016
primary_energy <-
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`) %>%
mutate(million_tonnes_equivalent = as.numeric(million_tonnes_equivalent))
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy %>%
filter(stringr::str_detect(country, "China "))
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>% View()
primary_energy <-
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
names(primary_energy)[2:ncol(primary_energy)] <- 1960:2016
primary_energy <-
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`)
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>% View()
primary_energy <-
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
names(primary_energy)[2:ncol(primary_energy)] <- 1960:2016
primary_energy <-
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`) %>%
mutate(million_tonnes_equivalent =
gsub(" ", "", million_tonnes_equivalent)) %>%
mutate(million_tonnes_equivalent = as.numeric(million_tonnes_equivalent))
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>% View()
primary_energy %>%
filter(stringr::str_detect(country, "China ")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy_clean <-
primary_energy %>%
filter(year %in% 1970:2015)
primary_energy_clean %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy_clean <-
primary_energy %>%
filter(year %in% 1971:2015)
primary_energy_clean %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy_clean %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy_clean %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
theme(legend.position = "none")
primary_energy_clean <-
primary_energy %>%
filter(year %in% 1990:2015)
primary_energy_clean %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
primary_energy_clean %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
theme(legend.position = "none")
primary_energy %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
theme(legend.position = "none")
primary_energy %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme +
theme(legend.position = "none")
primary_energy_clean %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
is.na(primary_energy$million_tonnes_equivalent) %>% table()
is.na(primary_energy_clean$million_tonnes_equivalent) %>% table()
is.na(primary_energy$million_tonnes_equivalent) %>% table() %>%
knitr::kable(caption = "Missing Data From Entire Dataset")
is.na(primary_energy_clean$million_tonnes_equivalent) %>% table() %>%
knitr::kable(caption = "Missing Data From 1990 Onwards")
?knitr::knit
library(tidyverse)
primary_energy_clean %>%
filter(stringr::str_detect(country, "China |United States|India")) %>%
ggplot(aes(year, million_tonnes_equivalent, fill = country)) +
geom_bar(stat = "identity") +
blorg::blog_theme
is.na(primary_energy$million_tonnes_equivalent) %>% table() %>%
knitr::kable(caption = "Missing Data From Entire Dataset")
is.na(primary_energy_clean$million_tonnes_equivalent) %>% table() %>%
knitr::kable(caption = "Missing Data From 1990 Onwards")
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent))
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent)) %>% View()
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent)) %>% select(country) %>% unique(
)
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent)) %>% select(country) %>% unique()
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent)) %>% select(country) %>%
unique() %>% knitr::kable(caption = "Countries with missing data between 1990 - 2015")
library(tidyverse)
primary_energy_clean %>%
filter(is.na(million_tonnes_equivalent)) %>% select(country) %>%
unique() %>% knitr::kable(caption = "Countries with missing data between 1990 - 2015")
problems()
primary_energy <-
readr::read_tsv("./data/primary_energy_draft.tsv") %>%
select(country:X58)
problems()
names(primary_energy)[2:ncol(primary_energy)] <- 1960:2016
primary_energy <-
primary_energy %>%
gather("year", "million_tonnes_equivalent", `1960`:`2016`) %>%
mutate(million_tonnes_equivalent =
gsub(" ", "", million_tonnes_equivalent)) %>%
mutate(million_tonnes_equivalent = as.numeric(million_tonnes_equivalent))
primary_energy_clean <-
primary_energy %>%
filter(year %in% 1990:2015)
?dplyr::lag
growth <- function(x) {x / lag(x)}
primary_energy_clean %>%
group_by(year) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent))
primary_energy_clean %>%
group_by(year) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent)) %>%
filter(country = "Ireland") %>%
arrange(year)
primary_energy_clean %>%
group_by(year) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent)) %>%
filter(country == "Ireland") %>%
arrange(year)
9.99/9.91
primary_energy_clean %>%
group_by(year, country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent)) %>%
filter(country == "Ireland") %>%
arrange(year)
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent)) %>%
filter(country == "Ireland") %>%
arrange(year)
9.99/9.91
growth <- function(x) {(x / lag(x)) - 1}
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent)) %>%
filter(country == "Ireland") %>%
arrange(year)
abs_growth <- function(x) {x - lag(x)}
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent),
mtoe_abs_growth = abs_growth(million_tonnes_equivalent)) %>%
filter(country == "Ireland") %>%
arrange(year)
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent),
mtoe_abs_growth = abs_growth(million_tonnes_equivalent)) %>%
arrange(year)
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth = growth(million_tonnes_equivalent),
mtoe_abs_growth = abs_growth(million_tonnes_equivalent)) %>%
filter(year != 1990)
primary_energy_clean %>%
group_by(country) %>%
mutate(mtoe_growth =
(function(million_tonnes_equivalent) {(
million_tonnes_equivalent / lag(million_tonnes_equivalent)) - 1}),
mtoe_abs_growth = abs_growth(million_tonnes_equivalent)) %>%
filter(year != 1990)
primary_energy_clean %>%
group_by(country) %>%
mutate_each(funs(by_2 = (function(x){x/2})(.)), a, b) %>%
```
primary_energy_clean %>%
group_by(country) %>%
mutate_each(funs(mtoe_growth =
(function(x){(x / lag(x)) - 1})(.)),
million_tonnes_equivalent) %>%
filter(year != 1990)
primary_energy_clean %>%
group_by(country) %>%
mutate_each(funs(mtoe_growth =
(function(x){(x / lag(x)) - 1})(.)),
million_tonnes_equivalent) %>%
filter(year != 1990, country == "Ireland")
primary_energy_clean %>%
group_by(country) %>%
mutate_each(funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
million_tonnes_equivalent) %>%
filter(year != 1990, country == "Ireland")
tribble(
~x, ~y,
"a", 1,
"a", 2,
"a", 4,
"a", 6,
"b", 1,
"b", 1,
)
9.99/9.91
df <-
tribble(
~x, ~y,
"a", 1,
"a", 2,
"a", 4,
"a", 6,
"b", 1,
"b", 2,
"b", 3,
"b", 4,
)
df <-
tribble(
~x, ~y,
"a", 1,
"a", 2,
"a", 4,
"a", 6,
"b", 1,
"b", 2,
"b", 3,
"b", 4
)
df %>%
group_by(x) %>%
mutate(x_growth = growth(x))
df %>%
group_by(x) %>%
mutate(y_growth = growth(y))
growth <- function(x) {(x / lag(x)) - 1}
abs_growth <- function(x) {x - lag(x)}
df %>%
group_by(x) %>%
mutate(y_growth = growth(y),
y_abs_growth = abs_growth(y),)
df %>%
group_by(x) %>%
mutate(y_growth = growth(y),
y_abs_growth = abs_growth(y))
df %>%
group_by(x) %>%
mutate_each(funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
million_tonnes_equivalent) %>%
mutate_each(funs(abs_growth =
(function(x){(x - lag(x))})(.)),
million_tonnes_equivalent)
df %>%
group_by(x) %>%
mutate_each(funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
y)
df %>%
group_by(x) %>%
mutate_each(funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
y) %>%
mutate_each(funs(abs_growth =
(function(x){(x - lag(x))})(.)),
y)
df %>%
group_by(x) %>%
mutate_at(funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
y) %>%
mutate_at(funs(abs_growth =
(function(x){(x - lag(x))})(.)),
y)
df %>%
group_by(x) %>%
mutate_at(.funs = funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
.vars = vars(y))
df %>%
group_by(x) %>%
mutate_at(.funs = funs(growth =
(function(x){(x / lag(x)) - 1})(.)),
.vars = vars(y)) %>%
mutate_at(.funs = funs(abs_growth =
(function(x){(x - lag(x))})(.)),
.vars = vars(y))
df %>%
group_by(x) %>%
mutate_at(.funs = funs(y_growth =
(function(x){(x / lag(x)) - 1})(.),
abs_growth =
(function(x){(x - lag(x))})(.)),
.vars = vars(y))
(function(x){(x / lag(x)) - 1})(df)
function(x){(x / lag(x)) - 1}(df)
readr::read_csv("./data/renewable_primary_energy.csv")
readr::read_csv("./data/primary_energy.csv")
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(tolower)
replace_space <- function(x) {str_replace(x, " ", "_")}
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(tolower) %>% rename_all(replace_space)
replace_space <- function(x) {stringr::str_replace(x, " ", "_")}
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(tolower) %>% rename_all(replace_space)
clean_colnames <- function(x) {tolower(stringr::str_replace(x, " ", "_"))}
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_colnames)
clean_names <- function(x) {tolower(stringr::str_replace(x, " ", "_"))}
function(x){(x / lag(x)) - 1}(df)rm(clean_colnames())
rm(clean_colnames())
rm(clean_colnames
)
rm(replace_space)
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject) %>%
filter(measure = "MLN_TOE")
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject) %>%
filter(measure == "MLN_TOE")
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject) %>%
filter(measure == "MLN_TOE") %>%
rename(country = location, year = time, million_tonnes_equivalent = value)
primary_energy <-
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject) %>%
filter(measure == "MLN_TOE") %>%
rename(country = location, year = time, million_tonnes_equivalent = value)
primary_energy <-
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject, -indicator, -measure) %>%
filter(measure == "MLN_TOE") %>%
rename(country = location, year = time, million_tonnes_equivalent = value)
primary_energy <-
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject, -indicator) %>%
filter(measure == "MLN_TOE") %>%
rename(country = location, year = time,
million_tonnes_equivalent = value) %>%
select(-measure)
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject, -indicator) %>%
filter(measure == "MLN_TOE",
!(location %in% c("G20", "EU28", "OECD", "OEU", "WLD"))) %>%
rename(country = location, year = time,
million_tonnes_equivalent = value) %>%
select(-measure)
readr::read_csv("./data/primary_energy.csv") %>%
rename_all(clean_names) %>%
select(-flag_codes, -frequency, -subject, -indicator) %>%
filter(measure == "MLN_TOE",
!(location %in% c("G20", "EU28", "OECD", "OEU", "WLD"))) %>%
rename(country_iso3 = location, year = time,
million_tonnes_equivalent = value) %>%
select(-measure)
